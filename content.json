{"pages":[{"title":"About","text":"00åï¼Œç°å±…åŒ—äº¬ã€‚ é«˜ä¸­æ—¶å€™å‚åŠ è¿‡ç®—æ³•ç«èµ›ï¼Œå¤§å­¦ä¸»ä¿®è®¡ç®—æœºï¼Œç¡•å£«ç ”ç©¶ç”Ÿé˜¶æ®µä»äº‹æœºå™¨äººç›¸å…³çš„ç ”ç©¶ã€‚ ç›®å‰åœ¨ç™¾åº¦ä»äº‹ç®—æ³•ç­–ç•¥çš„å·¥ä½œã€‚ ğŸµ ä¼šå¼¹ä¸€ç‚¹å‰ä»–ã€‚å–œæ¬¢R&amp;Bå’ŒSoulã€‚ç›¸æ¯”ç”µå­ä¹æ›´å–œæ¬¢çœŸå®çš„ä¹å™¨æ¼”å¥ã€‚ ğŸ® ä¸»æœºæ¸¸æˆç©å®¶ã€‚å–œæ¬¢RPGå’ŒåŠ¨ä½œå†’é™©ç±»æ¸¸æˆã€‚3Dçœ©æ™•æ‚£è€…ï¼Œä¸FPSæ¸¸æˆæ— ç¼˜ã€‚ ğŸ’» å–œæ¬¢å¼€æºè½¯ä»¶ã€‚å¯æƒœç°åœ¨è¿˜æ²¡æœ‰ä»€ä¹ˆæ‹¿å¾—å‡ºæ‰‹çš„é¡¹ç›®ã€‚ ğŸ± å–œæ¬¢çŒ«ã€‚ ğŸ’­ æ¢¦æƒ³æ˜¯æˆä¸ºä¸“å®¶ã€‚","link":"/about/index.html"}],"posts":[{"title":"æˆ‘çš„Zoteroé…ç½®","text":"æœ¬æ–‡å¯¹Zoteroçš„é…ç½®è¿›è¡Œäº†æ•´ç†ï¼Œä¾›è‡ªå·±å°†æ¥å‚è€ƒã€‚ Zoteroä½œä¸ºæ–‡çŒ®ç®¡ç†è½¯ä»¶ï¼Œåœ¨æ•´ä¸ªå·¥ä½œæµä¸­æ‹…ä»»å¯¹æ–‡çŒ®çš„æ•´ç†ã€é˜…è¯»ç®¡ç†ä»»åŠ¡ï¼Œå¹¶æä¾›é¢å‘ä¸Šæ¸¸è¾“å…¥ä¸ä¸‹æ¸¸è¾“å‡ºçš„æ¥å£ã€‚ åœ¨æ–‡çŒ®çš„è¾“å…¥éƒ¨åˆ†ï¼Œé€šè¿‡Zoteroæµè§ˆå™¨æ’ä»¶å’ŒSci-Hubè§£æå™¨å®ç°å¯¹è‹±æ–‡æ–‡çŒ®æºä¿¡æ¯å’Œpdfçš„ä¸€é”®æŠ“å–ï¼Œé€šè¿‡èŒ‰è‰èŠ±æ’ä»¶å®ç°å¯¹çŸ¥ç½‘æ–‡çŒ®çš„æŠ“å–ã€‚æ”¶é›†åˆ°æ–‡çŒ®ä¹‹åZoteroä¼šé€šè¿‡WebDavåœ¨å¤šä¸ªè®¾å¤‡é—´è¿›è¡ŒåŒæ­¥ï¼Œåœ¨é˜…è¯»è¿‡ç¨‹ä¸­åˆ©ç”¨ç¿»è¯‘æ’ä»¶å¯¹è‹±æ–‡æ–‡çŒ®å®ç°é€‰ä¸­ç¿»è¯‘ï¼Œåˆ©ç”¨Markdownæ’ä»¶å®ç°æ›´å¼ºå¤§çš„å†…ç½®ç¬”è®°ã€‚åœ¨å†™ä½œè¾“å‡ºé˜¶æ®µï¼Œé€šè¿‡Zoteroå®˜æ–¹çš„Wordæ’ä»¶è”åŠ¨wordå¿«é€Ÿç”Ÿæˆå‚è€ƒæ–‡çŒ®ï¼Œå¹¶åˆ©ç”¨Wordå®å®ç°å‚è€ƒæ–‡çŒ®çš„äº¤å‰å¼•ç”¨ã€‚ è‡³æ­¤ï¼Œè¦†ç›–æ–‡çŒ®é˜…è¯»å…¨æµç¨‹çš„Zoteroå°±é…ç½®å®Œæˆäº†ã€‚ è¾“å…¥ æµè§ˆå™¨æ’ä»¶ Zoteroå®˜æ–¹æä¾›äº†æµè§ˆå™¨æ’ä»¶Zotero Connectorï¼Œæ”¯æŒChromeã€Safariã€MS Edgeç­‰æµè§ˆå™¨ï¼Œå¯ä»¥åœ¨å¯¹åº”æµè§ˆå™¨å®˜æ–¹çš„æ‰©å±•å•†åº—è¿›è¡Œå®‰è£…ã€‚ ä»¥Chormeä¸ºä¾‹ï¼Œå¯ä»¥åœ¨Chome ç½‘ä¸Šå•†åº—è¿›è¡Œä¸‹è½½å®‰è£…ã€‚ Sci-Hub è§£æå™¨ å‚è€ƒè¿™ç¯‡æ–‡ç« é…ç½®Sci-Hubè§£æå™¨ï¼Œé…åˆæµè§ˆå™¨æ’ä»¶ä½¿ç”¨ï¼Œå¯ä»¥ç›´æ¥åœ¨Sci-Hubä¸‹è½½æ–‡çŒ®ã€‚ ä¿®æ”¹extensions.zotero.findPDFs.resolversä¸º 123456789{ \"name\":\"Sci-Hub\", \"method\":\"GET\", \"url\":\"https://sci-hub.ren/{doi}\", \"mode\":\"html\", \"selector\":\"#pdf\", \"attribute\":\"src\", \"automatic\":true} çŸ¥ç½‘æ–‡çŒ®æŠ“å– å®‰è£…èŒ‰è‰èŠ±æ’ä»¶ã€PDFtk Serverï¼Œå¹¶æ›´æ–°è§£æå™¨ï¼ˆTranslatorï¼‰ï¼ŒZoteroå’Œç½‘é¡µæ’ä»¶éƒ½è¦æ›´æ–°ï¼Œå¯èƒ½éœ€è¦å¤šç‚¹å‡ æ¬¡æ›´æ–°ã€‚ èŒ‰è‰èŠ±æ’ä»¶åœ¨è¿™ä¸ªä»“åº“ä¸‹è½½xpiæŒ‰ç…§æ–‡æ¡£å®‰è£…å³å¯ã€‚ PDFtk ServeræŒ‰ç…§å®˜ç½‘æŒ‡ç¤ºè¿›è¡Œå®‰è£…å³å¯ã€‚ å¤„ç† åˆ©ç”¨WebDavå¤šç«¯åŒæ­¥ Zoteroä½œä¸ºè·¨å¹³å°è½¯ä»¶ï¼Œåœ¨å„ä¸ªè®¾å¤‡ä¸Šéƒ½æœ‰è‡ªå·±çš„å®¢æˆ·ç«¯ï¼Œæˆ‘å¸Œæœ›èƒ½åœ¨iPadç«¯å’ŒMac/PCç«¯åŒæ­¥PDFå’Œæ ‡æ³¨ã€‚Zoteroå®˜æ–¹æä¾›äº†ä¸€ä¸ªäº‘åŒæ­¥æœåŠ¡ï¼Œä½†æ˜¯é€Ÿåº¦æ¯”è¾ƒæ…¢ï¼Œè€Œä¸”å…è´¹ä½¿ç”¨é™åˆ¶äº†300MBçš„å®¹é‡ï¼Œä¸èƒ½æ»¡è¶³æˆ‘çš„æ–‡çŒ®åŒæ­¥è¦æ±‚ã€‚å› æ­¤é€‰æ‹©åšæœäº‘çš„WebDavæœåŠ¡è¿›è¡ŒåŒæ­¥ã€‚ å…³äºZoteroå¦‚ä½•ä½¿ç”¨åšæœäº‘ï¼Œå¯ä»¥æŸ¥çœ‹åšæœäº‘å®˜æ–¹çš„è¿™ç¯‡æ–‡æ¡£ã€‚ ç¿»è¯‘æ’ä»¶ å®‰è£…Zotero PDF Translateæ’ä»¶ï¼Œåœ¨è¿™ä¸ªä»“åº“ä¸‹è½½xpiæŒ‰ç…§æ–‡æ¡£å®‰è£…å³å¯ã€‚ Markdownç¬”è®°æ’ä»¶ å®‰è£…markdownhere4zoteroæ’ä»¶ï¼Œåœ¨è¿™ä¸ªä»“åº“ä¸‹è½½xpiå¹¶å®‰è£…å³å¯ã€‚è¯¥æ’ä»¶çš„å…¬å¼æ¸²æŸ“é»˜è®¤ä½¿ç”¨è°·æ­Œçš„æœåŠ¡ï¼Œå¯ä»¥æŒ‰ç…§è¿™ç¯‡æ–‡ç« ä¿®æ”¹è‡³å›½å†…æœåŠ¡ã€‚ Update: åœ¨Zotero 6.0.14ç‰ˆæœ¬ä¸­ï¼Œå®˜æ–¹åœ¨ç¬”è®°ä¸­æ”¯æŒäº†å…¬å¼åŠŸèƒ½ã€‚ä½†æ˜¯ç”±äºä¸æ˜¯å…¨åŠŸèƒ½markdownï¼Œæ’å…¥å›¾ç‰‡ç­‰è¿˜æ˜¯ä¸æ”¯æŒã€‚ è¾“å‡º Wordæ’ä»¶ç”Ÿæˆå‚è€ƒæ–‡çŒ® Zoteroå®‰è£…æ—¶ä¼šè‡ªåŠ¨åœ¨Wordæ·»åŠ æ’ä»¶ï¼Œå¯ä»¥åœ¨èœå•æ çœ‹åˆ°ï¼Œå¦‚æœå‡ºç°æ‰¾ä¸åˆ°æ’ä»¶çš„æƒ…å†µï¼Œ å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« æ‰‹åŠ¨å°†æ’ä»¶å¤åˆ¶åˆ°Wordå¯åŠ¨é¡¹ä¸­ã€‚ å¦‚æœZoteroæ²¡æœ‰æ‰€éœ€çš„å¼•ç”¨æ ¼å¼ï¼Œå¯ä»¥åœ¨è®¾ç½®-å¼•ç”¨-æ ·å¼-è·å–æ›´å¤šæ ·å¼ä¸­æœç´¢å¹¶å®‰è£…ã€‚ å‚è€ƒæ–‡çŒ®äº¤å‰å¼•ç”¨ å…ˆæ­£å¸¸ä½¿ç”¨Zoteroæ·»åŠ å‚è€ƒæ–‡çŒ®ï¼Œç„¶ååˆ©ç”¨Wordå®å®ç°ä¿®æ”¹å‚è€ƒæ–‡çŒ®ä¸ºäº¤å‰å¼•ç”¨ã€‚ç”±äºZoteroæœ¬èº«æ·»åŠ å‚è€ƒæ–‡çŒ®ä¹Ÿæ˜¯åˆ©ç”¨Wordå®å®ç°çš„ï¼Œå°†æ¥å®˜æ–¹å¯èƒ½ä¹Ÿä¼šæ·»åŠ äº¤å‰å¼•ç”¨çš„åŠŸèƒ½ã€‚ å¯¹äºå¦‚ä½•æ·»åŠ Wordå®å‚è€ƒè¿™ç¯‡æ–‡ç« ã€‚ å®ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216Public Sub ZoteroLinkCitation() ' get selected area (if applicable) Dim nStart&amp;, nEnd&amp; nStart = Selection.Start nEnd = Selection.End ' toggle screen updating Application.ScreenUpdating = False ' define variables Dim title As String Dim titleAnchor As String Dim style As String Dim fieldCode As String Dim numOrYear As String Dim pos&amp;, n1&amp;, n2&amp;, n3&amp; ActiveWindow.View.ShowFieldCodes = True Selection.Find.ClearFormatting ' find the Zotero bibliography With Selection.Find .Text = \"^d ADDIN ZOTERO_BIBL\" .Replacement.Text = \"\" .Forward = True .Wrap = wdFindContinue .Format = False .MatchCase = False .MatchWholeWord = False .MatchWildcards = False .MatchSoundsLike = False .MatchAllWordForms = False End With Selection.Find.Execute ' add bookmark for the Zotero bibliography With ActiveDocument.Bookmarks .Add Range:=Selection.Range, Name:=\"Zotero_Bibliography\" .DefaultSorting = wdSortByName .ShowHidden = True End With ' loop through each field in the document For Each aField In ActiveDocument.Fields ' check if the field is a Zotero in-text reference '################################################## If InStr(aField.Code, \"ADDIN ZOTERO_ITEM\") &gt; 0 Then fieldCode = aField.Code '############# ' Prepare ' Plain citation== Format of Textfield shown ' must be in Brackets Dim plain_Cit As String plCitStrBeg = \"\"\"plainCitation\"\":\"\"[\" plCitStrEnd = \"]\"\"\" n1 = InStr(fieldCode, plCitStrBeg) n1 = n1 + Len(plCitStrBeg) n2 = InStr(Mid(fieldCode, n1, Len(fieldCode) - n1), plCitStrEnd) - 1 + n1 plain_Cit = Mid$(fieldCode, n1 - 1, n2 - n1 + 2) 'Reference 'as shown' in word as a string 'Title array in fieldCode (all referenced Titles within this field) Dim array_RefTitle(32) As String i = 0 Do While InStr(fieldCode, \"\"\"title\"\":\"\"\") &gt; 0 n1 = InStr(fieldCode, \"\"\"title\"\":\"\"\") + Len(\"\"\"title\"\":\"\"\") n2 = InStr(Mid(fieldCode, n1, Len(fieldCode) - n1), \"\"\",\"\"\") - 1 + n1 If n2 &lt; n1 Then 'Exception the type 'Article' n2 = InStr(Mid(fieldCode, n1, Len(fieldCode) - n1), \"}\") - 1 + n1 - 1 End If array_RefTitle(i) = Mid(fieldCode, n1, n2 - n1) fieldCode = Mid(fieldCode, n2 + 1, Len(fieldCode) - n2 - 1) i = i + 1 Loop Titles_in_Cit = i 'Number array with References shown in PlainCit 'Numer is equal or less than Titels, depending on the type '[3], [8]-[10]; [2]-[4]; [2], [4], [5] ' All citations have to be in Brackets each! [3], [8] not [3, 8] ' This doesnt work otherwise! ' --&gt; treatment of other delimiters could be implemented here Dim RefNumber(32) As String i = 0 Do While (InStr(plain_Cit, \"]\") Or InStr(plain_Cit, \"[\")) &gt; 0 n1 = InStr(plain_Cit, \"[\") n2 = InStr(plain_Cit, \"]\") RefNumber(i) = Mid(plain_Cit, n1 + 1, n2 - (n1 + 1)) plain_Cit = Mid(plain_Cit, n2 + 1, Len(plain_Cit) - (n2 + 1) + 1) i = i + 1 Loop Refs_in_Cit = i 'treat only the shown references (skip the rest) '[3], [8]-[10] --&gt; skip [9] 'Order of titles given from fieldcode, not checked! If Titles_in_Cit &gt; Refs_in_Cit Then array_RefTitle(Refs_in_Cit - 1) = array_RefTitle(Titles_in_Cit - 1) i = 1 Do While Refs_in_Cit + i &lt;= Titles_in_Cit array_RefTitle(Refs_in_Cit + i - 1) = \"\" i = i + 1 Loop End If '############# 'Make the links For Refs = 0 To Refs_in_Cit - 1 Step 1 title = array_RefTitle(Refs) array_RefTitle(Refs) = \"\" ' make title a valid bookmark name titleAnchor = title titleAnchor = MakeValidBMName(titleAnchor) ActiveWindow.View.ShowFieldCodes = False Selection.GoTo What:=wdGoToBookmark, Name:=\"Zotero_Bibliography\" '' locate the corresponding reference in the bibliography '' by searching for its title Selection.Find.ClearFormatting With Selection.Find .Text = Left(title, 255) .Replacement.Text = \"\" .Forward = True .Wrap = wdFindContinue .Format = False .MatchCase = False .MatchWholeWord = False .MatchWildcards = False .MatchSoundsLike = False .MatchAllWordForms = False End With Selection.Find.Execute ' select the whole caption (for mouseover tooltip) Selection.MoveStartUntil (\"[\"), Count:=wdBackward Selection.MoveEndUntil (vbBack) lnkcap = \"[\" &amp; Selection.Text lnkcap = Left(lnkcap, 70) ' add bookmark for the reference within the bibliography Selection.Shrink With ActiveDocument.Bookmarks .Add Range:=Selection.Range, Name:=titleAnchor .DefaultSorting = wdSortByName .ShowHidden = True End With ' jump back to the field aField.Select ' find and select the numeric part of the field which will become the hyperlink Selection.Find.ClearFormatting With Selection.Find .Text = RefNumber(Refs) .Replacement.Text = \"\" .Forward = True .Wrap = wdFindContinue .Format = False .MatchCase = False .MatchWholeWord = False .MatchWildcards = False .MatchSoundsLike = False .MatchAllWordForms = False End With Selection.Find.Execute numOrYear = Selection.Range.Text &amp; \"\" ' store current style style = Selection.style ' Generate the Hyperlink --&gt;Forward! ActiveDocument.Hyperlinks.Add Anchor:=Selection.Range, Address:=\"\", SubAddress:=titleAnchor, ScreenTip:=lnkcap, TextToDisplay:=\"\" &amp; numOrYear ' reset the style Selection.style = style ' comment if you want standard link style aField.Select With Selection.Font .Underline = wdUnderlineNone .ColorIndex = wdBlack End With Next Refs 'References in Cit End If 'If Zotero-Field '######################### Next aField ' next field ' go back to original range selected ActiveWindow.View.ShowFieldCodes = False ActiveDocument.Range(nStart, nEnd).Select End Sub Function MakeValidBMName(strIn As String) Dim pFirstChr As String Dim i As Long Dim tempStr As String strIn = Trim(strIn) pFirstChr = Left(strIn, 1) If Not pFirstChr Like \"[A-Za-z]\" Then strIn = \"A_\" &amp; strIn End If For i = 1 To Len(strIn) Select Case Asc(Mid$(strIn, i, 1)) Case 49 To 57, 65 To 90, 97 To 122 tempStr = tempStr &amp; Mid$(strIn, i, 1) Case Else tempStr = tempStr &amp; \"_\" End Select Next i tempStr = Replace(tempStr, \" \", \" \") MakeValidBMName = Left(tempStr, 40) End Function","link":"/2022/09/28/%E6%88%91%E7%9A%84Zotero%E9%85%8D%E7%BD%AE/"},{"title":"ä½¿ç”¨touch idéªŒè¯sudo","text":"sudoæƒé™ä¿®æ”¹æ–‡ä»¶/etc/pam.d/sudoï¼Œåœ¨pam_smartcard.soçš„ä¸‹ä¸€è¡Œæ·»åŠ auth sufficient pam_tid.soï¼Œä¿å­˜å³å¯ã€‚ æ¥æºï¼šUse TouchID to Authenticate sudo on macOS","link":"/2022/10/30/%E4%BD%BF%E7%94%A8touch-id%E9%AA%8C%E8%AF%81sudo/"},{"title":"Nginxé…ç½®ModSecurity","text":"æ‘˜è¦ï¼š æœ¬æ–‡ä»‹ç»äº†WAFï¼ˆWeb Application Firewallï¼‰ä¸­çš„ModSecurityï¼Œå®ƒæ˜¯ä¸€ä¸ªç”¨äºè¿‡æ»¤å’Œæ‹¦æˆªHTTPæµé‡çš„WAFï¼Œé€šå¸¸éƒ¨ç½²åœ¨åå‘ä»£ç†æœåŠ¡å™¨ä¸­ã€‚ModSecurityé€šè¿‡ä¸€ç»„è§„åˆ™é›†è¿›è¡Œå·¥ä½œï¼Œå¹¶å…è®¸ç”¨æˆ·æŒ‡å®šéœ€è¦è¿‡æ»¤çš„è¯·æ±‚ç‰¹å¾ä»¥åŠæœåŠ¡å™¨åº”è¯¥é‡‡å–çš„æ“ä½œã€‚æ–‡ç« æä¾›äº†ç¼–è¯‘ModSecurityçš„æ­¥éª¤ï¼ŒåŒ…æ‹¬ä»GitHubå…‹éš†æºç å¹¶è§£å†³ç¼–è¯‘è¿‡ç¨‹ä¸­çš„ä¾èµ–é—®é¢˜ã€‚æ¥ä¸‹æ¥ï¼Œæ–‡ç« ä»‹ç»äº†å¦‚ä½•å°†ModSecurityä¸NginxæœåŠ¡å™¨è¿æ¥èµ·æ¥ï¼Œé€šè¿‡ç¼–è¯‘ModSecurity-nginxå’ŒNginxï¼Œå¹¶é…ç½®Nginxä»¥ä½¿ç”¨ModSecurityã€‚æœ€åï¼Œæ–‡ç« æ¼”ç¤ºäº†å¦‚ä½•å¯åŠ¨ModSecurityå¹¶é…ç½®WAFè¿‡æ»¤è§„åˆ™ï¼ŒåŒ…æ‹¬æŒ‡å®šè§„åˆ™é›†å’Œä½¿ç”¨è‡ªå®šä¹‰è§„åˆ™é›†ã€‚é€šè¿‡è¿™äº›æ­¥éª¤ï¼Œè¯»è€…å¯ä»¥äº†è§£å¦‚ä½•ä½¿ç”¨ModSecurityæ„å»ºå’Œé…ç½®WAFä»¥ä¿æŠ¤Webåº”ç”¨ç¨‹åºã€‚ WAF - ModSecurity ModSecurityæ˜¯ä¸€ä¸ªWAFï¼ˆWeb Application Firewallï¼‰ï¼Œå¯ä»¥è¿‡æ»¤å¹¶æ‹¦æˆªHttpæµé‡ï¼Œé€šå¸¸è¢«éƒ¨ç½²åœ¨åå‘ä»£ç†æœåŠ¡å™¨ä¸­ã€‚ WAFé€šå¸¸æ ¹æ®ä¸€ç»„è§„åˆ™é›†ï¼ˆCore Rule Setï¼‰è¿›è¡Œå·¥ä½œï¼Œç”¨æˆ·å¯ä»¥æŒ‡å®šéœ€è¦è¿‡æ»¤çš„è¯·æ±‚ç‰¹å¾ï¼Œå¹¶ç»™å‡ºæœåŠ¡å™¨æ‰€éœ€è¿›è¡Œçš„æ“ä½œã€‚ ç¯å¢ƒè¯´æ˜ ç¼–è¯‘ModSecurity ä»Githubå…‹éš†æºç ï¼šhttps://github.com/SpiderLabs/ModSecurity 1234$ ./build.sh$ ./configure$ make$ sudo make install åˆ©ç”¨makeè¿›è¡Œç¼–è¯‘ï¼Œè¯¥é¡¹ç›®çš„makefileé€šè¿‡./configureè‡ªåŠ¨ç”Ÿæˆã€‚åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­æ¶‰åŠä¸€äº›ä¾èµ–ï¼š pcreï¼šæ­£åˆ™è¡¨è¾¾å¼åº“ YAJLï¼šJsonè§£æåº“ LMDBï¼šKey-Valueæ•°æ®åº“ GeoIPï¼šIPä¸åœ°ç†ä½ç½®æ˜ å°„ç®¡ç† libmaxminddbï¼šåœ°ç†ä½ç½®æ•°æ®åº“ å¯ä»¥å»å¯¹åº”ç½‘ç«™ä¸‹è½½æºç æ‰‹åŠ¨ç¼–è¯‘ï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨åŒ…ç®¡ç†å™¨å®‰è£…ç›¸å…³ä¾èµ–ã€‚è§£å†³ä¾èµ–é—®é¢˜åå³å¯å®‰è£…LibModSecurityã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940â¯ tree.â”œâ”€â”€ binâ”‚ â””â”€â”€ modsec-rules-checkâ”œâ”€â”€ includeâ”‚ â””â”€â”€ modsecurityâ”‚ â”œâ”€â”€ actionsâ”‚ â”‚ â””â”€â”€ action.hâ”‚ â”œâ”€â”€ anchored_set_variable.hâ”‚ â”œâ”€â”€ anchored_set_variable_translation_proxy.hâ”‚ â”œâ”€â”€ anchored_variable.hâ”‚ â”œâ”€â”€ audit_log.hâ”‚ â”œâ”€â”€ collectionâ”‚ â”‚ â”œâ”€â”€ collection.hâ”‚ â”‚ â””â”€â”€ collections.hâ”‚ â”œâ”€â”€ debug_log.hâ”‚ â”œâ”€â”€ intervention.hâ”‚ â”œâ”€â”€ modsecurity.hâ”‚ â”œâ”€â”€ reading_logs_via_rule_message.hâ”‚ â”œâ”€â”€ rule.hâ”‚ â”œâ”€â”€ rule_marker.hâ”‚ â”œâ”€â”€ rule_message.hâ”‚ â”œâ”€â”€ rule_unconditional.hâ”‚ â”œâ”€â”€ rule_with_actions.hâ”‚ â”œâ”€â”€ rule_with_operator.hâ”‚ â”œâ”€â”€ rules.hâ”‚ â”œâ”€â”€ rules_exceptions.hâ”‚ â”œâ”€â”€ rules_set.hâ”‚ â”œâ”€â”€ rules_set_phases.hâ”‚ â”œâ”€â”€ rules_set_properties.hâ”‚ â”œâ”€â”€ transaction.hâ”‚ â”œâ”€â”€ variable_origin.hâ”‚ â””â”€â”€ variable_value.hâ””â”€â”€ lib â”œâ”€â”€ libmodsecurity.3.dylib â”œâ”€â”€ libmodsecurity.a â”œâ”€â”€ libmodsecurity.dylib -&gt; libmodsecurity.3.dylib â”œâ”€â”€ libmodsecurity.la â””â”€â”€ pkgconfig â””â”€â”€ modsecurity.pc ç¼–è¯‘Nginxã€ModSecurity-nginx ModSecutiryå¯ä»¥éƒ¨ç½²äºå¤šç§ä¸åŒçš„WebæœåŠ¡å™¨ï¼ŒNginxï¼ŒApacheç­‰ç­‰ï¼Œä¸ºäº†èƒ½ç”¨äºä¸åŒçš„æœåŠ¡å™¨ï¼ŒModSecurityæä¾›äº†ä¸€ç³»åˆ—çš„è¿æ¥å™¨ï¼Œå°†å…¶ä¸å¯¹åº”çš„æœåŠ¡å™¨è¿æ¥èµ·æ¥ã€‚ ModSecurity-nginxæ˜¯è¿æ¥ModSecurityå’ŒNginxçš„æ¡¥æ¢ï¼Œä¸ºäº†ä½¿ModSecurityèƒ½éƒ¨ç½²äºNginxï¼Œéœ€è¦å°†ModSecurity-nginxä¸Nginxä¸€èµ·ç¼–è¯‘ï¼Œå¹¶è¿æ¥ä¸Šä¸€æ­¥å®‰è£…çš„ModSecurityé“¾æ¥åº“ã€‚ è¿™é‡Œæœ‰ä¸€ä¸ªå°å‘ï¼Œæˆ‘æœ€åˆåœ¨æœ¬åœ°æ˜¯ä½¿ç”¨ Homebrew å®‰è£…çš„ Nginxï¼Œä½†æ˜¯æ²¡æœ‰æ‰¾åˆ°å¦‚ä½•ä¸ºå…¶æ·»åŠ å¤–éƒ¨æ¨¡å—çš„æ–¹æ³•ï¼Œæœ€åä¸å¾—ä¸æ‰‹åŠ¨ç¼–è¯‘Nginx é¦–å…ˆéœ€è¦ä¸‹è½½Nginxæºç ï¼ˆhttps://github.com/nginx/nginxï¼‰ä¸ModSecurity-nginxæºç ï¼ˆhttps://github.com/SpiderLabs/ModSecurity-nginxï¼‰ï¼Œå¹¶åœ¨ç¼–è¯‘Nginxæ—¶å°†ModSecurity-nginxæŒ‡å®šä¸ºå…¶å¤–éƒ¨æ¨¡å—ï¼š 12./configure --add-module=/path/to/ModSecurity-nginxsudo make install åœ¨ç¼–è¯‘Nginxæ—¶é‡åˆ°é—®é¢˜ï¼Œæ€»æ˜¯æç¤ºæ— æ³•æ‰¾åˆ°ModSecurityé“¾æ¥åº“ï¼ŒæŒ‰ç…§ç½‘ä¸Šçš„åšæ³•è®¾ç½®ç¯å¢ƒå˜é‡ï¼š 1234# modsecurityexport MODSECURITY_LIB=\"/usr/local/modsecurity/lib\"export MODSECURITY_INC=\"/usr/local/modsecurity/include\"export LD_LIBRARY_PATH=\"/usr/local/modsecurity/lib\" åä»ç„¶æŠ¥é”™ã€‚é€šè¿‡æ£€æŸ¥ç¼–è¯‘è„šæœ¬å‘ç°ï¼Œè„šæœ¬ä¼šåœ¨æ£€æŸ¥å®ŒNginxæœ¬èº«çš„æ¡ä»¶ä¹‹åæ£€æŸ¥ç¬¬ä¸‰æ–¹æ¨¡å—çš„æ¡ä»¶ï¼Œè€ŒæŠ¥é”™çš„åŸå› åœ¨äºngx_foundè¿™ä¸ªå˜é‡æ²¡æœ‰è¢«æ­£ç¡®èµ‹å€¼ï¼š 12345678910 # modsecurity-nginx/config . auto/feature if [ $ngx_found = no ]; then cat &lt;&lt; END $0: error: ngx_http_modsecurity_module requires the ModSecurity library and MODSECURITY_LIB is defined as \"$MODSECURITY_LIB\" and MODSECURITY_INC (path for modsecurity.h) \"$MODSECURITY_INC\", but we cannot find ModSecurity there.END exit 1 fi è¿™ä¸ªå˜é‡å®šä¹‰è‡ªnginx-1.24.0/auto/featureï¼Œè¿›ä¸€æ­¥æ£€æŸ¥è„šæœ¬å‘ç°ï¼Œæµ‹è¯•çš„åŸç†æ˜¯æ‹¼è´´å‡ºä¸€æ®µCä»£ç ï¼Œå¹¶æŒ‰ç…§è¯»å–åˆ°çš„ç¯å¢ƒå˜é‡è¿›è¡Œç¼–è¯‘ï¼Œå¦‚æœèƒ½å¤Ÿç¼–è¯‘æˆåŠŸåˆ™è¯´æ˜åº“æ­£ç¡®å®‰è£…ã€‚ 1234567891011121314# nginx-1.24.0/auto/featurecat &lt;&lt; END &gt; $NGX_AUTOTEST.c#include &lt;sys/types.h&gt;$NGX_INCLUDE_UNISTD_H$ngx_feature_incsint main(void) { $ngx_feature_test; return 0;}END å…¶ä¸­çš„å˜é‡$ngx_feature_incså°±æ˜¯å¼•å…¥å¤´æ–‡ä»¶ngx_feature_incs=\"#include &lt;modsecurity/modsecurity.h&gt;\" $ngx_feature_testæ˜¯ç®€å•çš„ä¸€å¥è¾“å‡ºngx_feature_test='printf(\"hello\");' é—®é¢˜å‡ºç°åœ¨ä¸Šé¢çš„Cä»£ç ç”¨åˆ°äº†printfä½†æ˜¯å¹¶æ²¡æœ‰å¼•å…¥å¤´æ–‡ä»¶stdio.hï¼Œå¯¼è‡´æ— æ³•é€šè¿‡ç¼–è¯‘ã€‚ä½†æ˜¯è„šæœ¬è®¤ä¸ºæ²¡æœ‰é€šè¿‡ç¼–è¯‘å°±æ˜¯å› ä¸ºæ²¡æœ‰æ­£ç¡®å®‰è£…ModSecurityã€‚åªè¦æ·»åŠ ä¸€å¥#include&lt;stdio.h&gt;ï¼Œå³å¯æˆåŠŸå®Œæˆç¼–è¯‘ã€‚ å¯åŠ¨ModSecurityå¹¶é…ç½®WAFè¿‡æ»¤è§„åˆ™ åœ¨Nginxçš„é…ç½®æ–‡ä»¶ä¸­å¼€å¯modsecurtyå¹¶æŒ‡å®šå…¶é‡‡ç”¨çš„è§„åˆ™é›† 123456789# nginx.confmodsecurity on; # å¼€å¯ModSecuritylocation / { modsecurity_rules_file modsec_includes.conf; #æŒ‡å®šè§„åˆ™é›† root html; index index.html index.htm;} è§„åˆ™é›†ç®€å•èµ·è§ç›´æ¥ä½¿ç”¨owasp-modsecurity-crsï¼Œåœ¨ä¸‹è½½è§„åˆ™é›†åï¼Œå°†å…¶å¯¼å…¥åˆ°æˆ‘ä»¬çš„è‡ªå®šä¹‰è§„åˆ™é›†modsec_includes.confå½“ä¸­ï¼š 123include modsecurity.confinclude owasp-modsecurity-crs/crs-setup.confinclude owasp-modsecurity-crs/rules/*.conf é…ç½®å¥½è§„åˆ™ä¹‹åé‡å¯Nginxï¼Œç”¨curlå‘é€è¯·æ±‚ï¼Œå³å¯åœ¨logä¸­çœ‹åˆ°ã€‚ ä¸ºäº†æµ‹è¯•modsecurityçš„æ‹¦æˆªæ•ˆæœï¼Œè¯•ç€è‡ªå®šä¹‰è§„åˆ™é›†ä¸­æ·»åŠ ä¸€æ¡è§„åˆ™ï¼š 1SecRule ARGS:testparam \"@contains test\" \"id:1234,deny,status:403\" è¿™æ¡è§„åˆ™è¯´æ˜å½“è¯·æ±‚ä¸­åŒ…å«å‚æ•° testparam åŒæ—¶å…¶å€¼ä¸º test æ—¶ï¼Œæ‹¦æˆªè¯·æ±‚å¹¶è¿”å› 403ã€‚","link":"/2023/07/02/Nginx%E9%85%8D%E7%BD%AEModSecurity/"}],"tags":[{"name":"ç§‘ç ”","slug":"ç§‘ç ”","link":"/tags/%E7%A7%91%E7%A0%94/"},{"name":"å·¥å…·","slug":"å·¥å…·","link":"/tags/%E5%B7%A5%E5%85%B7/"},{"name":"MacOS","slug":"MacOS","link":"/tags/MacOS/"},{"name":"Linux","slug":"Linux","link":"/tags/Linux/"},{"name":"Nginx","slug":"Nginx","link":"/tags/Nginx/"},{"name":"ç½‘ç»œ","slug":"ç½‘ç»œ","link":"/tags/%E7%BD%91%E7%BB%9C/"}],"categories":[]}