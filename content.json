{"pages":[{"title":"about","text":"","link":"/about/index.html"}],"posts":[{"title":"我的Zotero配置","text":"本文对Zotero的配置进行了整理，供自己将来参考。 Zotero作为文献管理软件，在整个工作流中担任对文献的整理、阅读管理任务，并提供面向上游输入与下游输出的接口。 在文献的输入部分，通过Zotero浏览器插件和Sci-Hub解析器实现对英文文献源信息和pdf的一键抓取，通过茉莉花插件实现对知网文献的抓取。 收集到文献之后Zotero会通过WebDav在多个设备进行同步，在阅读过程中利用翻译插件对英文文献实现选中翻译，利用Markdown插件实现更强大的内置笔记。 在输出阶段，通过Zotero官方的Word插件联动word快速生成参考文献，并利用Word宏实现参考文献的交叉引用。 至此，覆盖文献阅读全流程的Zotero就配置完成了。 输入浏览器插件Zotero官方提供了浏览器插件Zotero Connector，支持Chrome、Safari、MS Edge等浏览器，可以在对应浏览器官方的扩展商店进行安装。 以Chorme为例，可以在Chome 网上商店进行下载安装。 Sci-Hub 解析器参考这篇文章配置Sci-Hub解析器，配合浏览器插件使用，可以直接在Sci-Hub下载文献。 修改extensions.zotero.findPDFs.resolvers为 123456789{ &quot;name&quot;:&quot;Sci-Hub&quot;, &quot;method&quot;:&quot;GET&quot;, &quot;url&quot;:&quot;https://sci-hub.ren/{doi}&quot;, &quot;mode&quot;:&quot;html&quot;, &quot;selector&quot;:&quot;#pdf&quot;, &quot;attribute&quot;:&quot;src&quot;, &quot;automatic&quot;:true} 知网文献抓取安装茉莉花插件、PDFtk Server，并更新解析器（Translator），Zotero和网页插件都要更新，可能需要多点几次更新。 茉莉花插件在这个仓库下载xpi按照文档安装即可。 PDFtk Server按照官网指示进行安装即可。 处理利用WebDav多端同步Zotero作为跨平台软件，在各个设备上都有自己的客户端，我希望能在iPad端和Mac/PC端同步PDF和标注。Zotero官方提供了一个云同步服务，但是速度比较慢，而且免费使用限制了300MB的容量，不能满足我的文献同步要求。因此选择坚果云的WebDav服务进行同步。 翻译插件安装Zotero PDF Translate插件，在这个仓库下载xpi按照文档安装即可。 Markdown笔记插件输出Word插件生成参考文献Zotero安装时会自动在Word添加插件，可以在菜单栏看到，如果出现找不到插件的情况， 可以参考这篇文章手动将插件复制到Word启动项中。 参考文献交叉引用先正常使用Zotero添加参考文献，然后利用Word宏实现修改参考文献为交叉应用。由于Zotero本身添加参考文献也是利用Word宏实现的，将来官方可能也会添加交叉引用的功能。 对于如何添加Word宏参考这篇文章。 宏代码如下： 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216Public Sub ZoteroLinkCitation() ' get selected area (if applicable) Dim nStart&amp;, nEnd&amp; nStart = Selection.Start nEnd = Selection.End ' toggle screen updating Application.ScreenUpdating = False ' define variables Dim title As String Dim titleAnchor As String Dim style As String Dim fieldCode As String Dim numOrYear As String Dim pos&amp;, n1&amp;, n2&amp;, n3&amp; ActiveWindow.View.ShowFieldCodes = True Selection.Find.ClearFormatting ' find the Zotero bibliography With Selection.Find .Text = &quot;^d ADDIN ZOTERO_BIBL&quot; .Replacement.Text = &quot;&quot; .Forward = True .Wrap = wdFindContinue .Format = False .MatchCase = False .MatchWholeWord = False .MatchWildcards = False .MatchSoundsLike = False .MatchAllWordForms = False End With Selection.Find.Execute ' add bookmark for the Zotero bibliography With ActiveDocument.Bookmarks .Add Range:=Selection.Range, Name:=&quot;Zotero_Bibliography&quot; .DefaultSorting = wdSortByName .ShowHidden = True End With ' loop through each field in the document For Each aField In ActiveDocument.Fields ' check if the field is a Zotero in-text reference '################################################## If InStr(aField.Code, &quot;ADDIN ZOTERO_ITEM&quot;) &gt; 0 Then fieldCode = aField.Code '############# ' Prepare ' Plain citation== Format of Textfield shown ' must be in Brackets Dim plain_Cit As String plCitStrBeg = &quot;&quot;&quot;plainCitation&quot;&quot;:&quot;&quot;[&quot; plCitStrEnd = &quot;]&quot;&quot;&quot; n1 = InStr(fieldCode, plCitStrBeg) n1 = n1 + Len(plCitStrBeg) n2 = InStr(Mid(fieldCode, n1, Len(fieldCode) - n1), plCitStrEnd) - 1 + n1 plain_Cit = Mid$(fieldCode, n1 - 1, n2 - n1 + 2) 'Reference 'as shown' in word as a string 'Title array in fieldCode (all referenced Titles within this field) Dim array_RefTitle(32) As String i = 0 Do While InStr(fieldCode, &quot;&quot;&quot;title&quot;&quot;:&quot;&quot;&quot;) &gt; 0 n1 = InStr(fieldCode, &quot;&quot;&quot;title&quot;&quot;:&quot;&quot;&quot;) + Len(&quot;&quot;&quot;title&quot;&quot;:&quot;&quot;&quot;) n2 = InStr(Mid(fieldCode, n1, Len(fieldCode) - n1), &quot;&quot;&quot;,&quot;&quot;&quot;) - 1 + n1 If n2 &lt; n1 Then 'Exception the type 'Article' n2 = InStr(Mid(fieldCode, n1, Len(fieldCode) - n1), &quot;}&quot;) - 1 + n1 - 1 End If array_RefTitle(i) = Mid(fieldCode, n1, n2 - n1) fieldCode = Mid(fieldCode, n2 + 1, Len(fieldCode) - n2 - 1) i = i + 1 Loop Titles_in_Cit = i 'Number array with References shown in PlainCit 'Numer is equal or less than Titels, depending on the type '[3], [8]-[10]; [2]-[4]; [2], [4], [5] ' All citations have to be in Brackets each! [3], [8] not [3, 8] ' This doesnt work otherwise! ' --&gt; treatment of other delimiters could be implemented here Dim RefNumber(32) As String i = 0 Do While (InStr(plain_Cit, &quot;]&quot;) Or InStr(plain_Cit, &quot;[&quot;)) &gt; 0 n1 = InStr(plain_Cit, &quot;[&quot;) n2 = InStr(plain_Cit, &quot;]&quot;) RefNumber(i) = Mid(plain_Cit, n1 + 1, n2 - (n1 + 1)) plain_Cit = Mid(plain_Cit, n2 + 1, Len(plain_Cit) - (n2 + 1) + 1) i = i + 1 Loop Refs_in_Cit = i 'treat only the shown references (skip the rest) '[3], [8]-[10] --&gt; skip [9] 'Order of titles given from fieldcode, not checked! If Titles_in_Cit &gt; Refs_in_Cit Then array_RefTitle(Refs_in_Cit - 1) = array_RefTitle(Titles_in_Cit - 1) i = 1 Do While Refs_in_Cit + i &lt;= Titles_in_Cit array_RefTitle(Refs_in_Cit + i - 1) = &quot;&quot; i = i + 1 Loop End If '############# 'Make the links For Refs = 0 To Refs_in_Cit - 1 Step 1 title = array_RefTitle(Refs) array_RefTitle(Refs) = &quot;&quot; ' make title a valid bookmark name titleAnchor = title titleAnchor = MakeValidBMName(titleAnchor) ActiveWindow.View.ShowFieldCodes = False Selection.GoTo What:=wdGoToBookmark, Name:=&quot;Zotero_Bibliography&quot; '' locate the corresponding reference in the bibliography '' by searching for its title Selection.Find.ClearFormatting With Selection.Find .Text = Left(title, 255) .Replacement.Text = &quot;&quot; .Forward = True .Wrap = wdFindContinue .Format = False .MatchCase = False .MatchWholeWord = False .MatchWildcards = False .MatchSoundsLike = False .MatchAllWordForms = False End With Selection.Find.Execute ' select the whole caption (for mouseover tooltip) Selection.MoveStartUntil (&quot;[&quot;), Count:=wdBackward Selection.MoveEndUntil (vbBack) lnkcap = &quot;[&quot; &amp; Selection.Text lnkcap = Left(lnkcap, 70) ' add bookmark for the reference within the bibliography Selection.Shrink With ActiveDocument.Bookmarks .Add Range:=Selection.Range, Name:=titleAnchor .DefaultSorting = wdSortByName .ShowHidden = True End With ' jump back to the field aField.Select ' find and select the numeric part of the field which will become the hyperlink Selection.Find.ClearFormatting With Selection.Find .Text = RefNumber(Refs) .Replacement.Text = &quot;&quot; .Forward = True .Wrap = wdFindContinue .Format = False .MatchCase = False .MatchWholeWord = False .MatchWildcards = False .MatchSoundsLike = False .MatchAllWordForms = False End With Selection.Find.Execute numOrYear = Selection.Range.Text &amp; &quot;&quot; ' store current style style = Selection.style ' Generate the Hyperlink --&gt;Forward! ActiveDocument.Hyperlinks.Add Anchor:=Selection.Range, Address:=&quot;&quot;, SubAddress:=titleAnchor, ScreenTip:=lnkcap, TextToDisplay:=&quot;&quot; &amp; numOrYear ' reset the style Selection.style = style ' comment if you want standard link style aField.Select With Selection.Font .Underline = wdUnderlineNone .ColorIndex = wdBlack End With Next Refs 'References in Cit End If 'If Zotero-Field '######################### Next aField ' next field ' go back to original range selected ActiveWindow.View.ShowFieldCodes = False ActiveDocument.Range(nStart, nEnd).Select End Sub Function MakeValidBMName(strIn As String) Dim pFirstChr As String Dim i As Long Dim tempStr As String strIn = Trim(strIn) pFirstChr = Left(strIn, 1) If Not pFirstChr Like &quot;[A-Za-z]&quot; Then strIn = &quot;A_&quot; &amp; strIn End If For i = 1 To Len(strIn) Select Case Asc(Mid$(strIn, i, 1)) Case 49 To 57, 65 To 90, 97 To 122 tempStr = tempStr &amp; Mid$(strIn, i, 1) Case Else tempStr = tempStr &amp; &quot;_&quot; End Select Next i tempStr = Replace(tempStr, &quot; &quot;, &quot; &quot;) MakeValidBMName = Left(tempStr, 40) End Function","link":"/2022/09/28/%E6%88%91%E7%9A%84Zotero%E9%85%8D%E7%BD%AE/"}],"tags":[{"name":"科研","slug":"科研","link":"/tags/%E7%A7%91%E7%A0%94/"},{"name":"工具","slug":"工具","link":"/tags/%E5%B7%A5%E5%85%B7/"}],"categories":[]}